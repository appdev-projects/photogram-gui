<!-- app/views/users/show.html.erb -->

<h1>User Profile</h1>

<p>
  <strong>ID:</strong> <%= @user.id %>
</p>

<p>
  <strong>Username:</strong> <%= @user.username %>
</p>

<h2>Update User</h2>
<%= form_with(model: @user, url: user_path(@user), method: :patch, local: true) do |f| %>
  <div>
    <%= f.label :username, "Username", for: "user_username" %><br>
    <%= f.text_field :username, id: "user_username", placeholder: "Enter new username" %>
  </div>
  <div>
    <%= button_tag "Update user", type: "submit" %>
  </div>
<% end %>

<p>
  <%= link_to "Delete user", user_path(@user),
              method: :delete,
              data: { confirm: "Are you sure you want to delete this user?" } %> |
  <%= link_to "Back to all users", users_path %>
</p>

<!-- New Section: Display the photos posted by the user -->
<h2>Photos posted by <%= @user.username %></h2>
<% if @user.own_photos.any? %>
  <ul>
    <% @user.own_photos.each do |photo| %>
      <li>
        <% if photo.image.present? %>
          <% display_url = photo.image.to_s %>
          <% unless display_url =~ /\Ahttps?:\/\//i %>
            <% display_url = "http://" + display_url %>
          <% end %>
          <%= image_tag(display_url, skip_pipeline: true, width: 100, alt: "Photo") %>
        <% else %>
          (No image)
        <% end %>
        <br>
        <strong>Caption:</strong> <%= photo.caption %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>No photos posted.</p>
<% end %>
